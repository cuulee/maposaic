(this.webpackJsonpmaposaic=this.webpackJsonpmaposaic||[]).push([[0],{118:function(e,t,a){e.exports=a(223)},123:function(e,t,a){},214:function(e,t,a){},223:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(6),o=a.n(c),i=(a(123),a(124),a(115)),l=(a(126),a(112)),s=a(41),u=a.n(s),m=a(53),d=a(13),f=a(61),p=a.n(f),b=a(227),g=a(226),h=(a(129),a(114)),v=(a(225),a(86)),w=(a(133),a(48)),y=(a(135),a(83)),E=a(116),j=(a(224),a(85)),x=j.a.Option,O=function(e){var t=e.flyTo,a=e.currentCenter,c=Object(n.useState)(""),o=Object(d.a)(c,2),i=o[0],l=o[1],s=Object(n.useState)([]),f=Object(d.a)(s,2),p=f[0],b=f[1],g=function(){var e=Object(m.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(t),!(t.length<1)){e.next=4;break}return b([]),e.abrupt("return");case 4:return n="".concat("https://api.mapbox.com/geocoding/v5/mapbox.places","/").concat(t,".json?limit=5&language=fr-FR&access_token=").concat(B,"&proximity=").concat(a[0],"%2C").concat(a[1]),e.next=7,fetch(n);case 7:return r=e.sent,e.next=10,r.json();case 10:c=e.sent,b(c.features);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=p.map((function(e){var t=e.place_name.split(","),a=Object(E.a)(t),n=a[0],c=a.slice(1);return r.a.createElement(x,{key:e.id,value:e.id},r.a.createElement("div",{style:{fontWeight:500}},n),r.a.createElement("div",null,c.join("")))}));return r.a.createElement(j.a,{style:{width:200},onSearch:g,onSelect:function(e){var a=p.find((function(t){return t.id===e}));a&&t(a.center)},value:i,placeholder:"Search location"},h)},C=function(e){var t=e.visible,a=e.setDrawerVisible,c=e.mapboxStyleURL,o=e.changeMapStyle,i=e.setNewRoadColorThreshold,l=e.setNewSimilarColorTolerance,s=e.flyTo,u=e.currentCenter,m=Object(n.useState)(N),f=Object(d.a)(m,2),p=f[0],b=f[1],g=Object(n.useState)(I),E=Object(d.a)(g,2),j=E[0],x=E[1],C=function(e,t){t("number"===typeof e?e:e[0])};return r.a.createElement(h.a,{visible:t,placement:"left",onClose:function(){return a(!1)},closable:!1},r.a.createElement(O,{flyTo:s,currentCenter:u}),r.a.createElement(y.a,null),r.a.createElement(w.a.Group,{onChange:function(e){o(e.target.value)},value:c},r.a.createElement(w.a,{value:T.road},"Road boundaries"),r.a.createElement(w.a,{value:T.water},"Water boundaries"),r.a.createElement(w.a,{value:T.administrative},"Administrative boundaries")),r.a.createElement(y.a,null),r.a.createElement("p",null,"Boundary detection threshold"),r.a.createElement(v.a,{min:0,max:255,range:!1,value:p,onAfterChange:function(){return i(p)},onChange:function(e){return C(e,b)}}),r.a.createElement("p",null,"Fill Color Tolerance"),r.a.createElement(v.a,{min:0,max:20,range:!1,value:j,onAfterChange:function(){return l(j)},onChange:function(e){return C(e,x)}}))},S=a(84),k=a.n(S),B=(a(214),"pk.eyJ1IjoiY2FydGFwdWNlIiwiYSI6ImNrODM4ZmRnbjB2cnYzZ21zZGpidGdtanEifQ.A61azybL3BMEPJtn42dXKw");p.a.accessToken=B;var T={road:"mapbox://styles/cartapuce/ck8vk01zo2e5w1ipmytroxgf4",water:"mapbox://styles/cartapuce/ck8ynyj0x022h1hpmffi87im9",administrative:"mapbox://styles/cartapuce/ck8vkvxjt27z71ila3b3jecka"},N=50,I=3,W={width:"100vw",height:"calc(100vh)",position:"absolute"},R=new k.a,z=function(e){var t=document.getElementById("mapbox-cvs"),a=document.getElementById("maposaic-cvs");t.style.opacity=e?"1":"0",a.style.opacity=e?"0":"1"},A=function(){var e=Object(n.useState)(null),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useRef)(null),s=Object(n.useState)(T.road),f=Object(d.a)(s,2),h=f[0],v=f[1],w=Object(n.useState)(!1),y=Object(d.a)(w,2),E=y[0],j=y[1],x=Object(n.useState)(N),O=Object(d.a)(x,2),S=O[0],B=O[1],A=Object(n.useState)(I),M=Object(d.a)(A,2),D=M[0],G=M[1],H=Object(n.useState)([0,0]),L=Object(d.a)(H,2),Z=L[0],F=L[1];Object(n.useEffect)((function(){var e=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,c,o,i,l,s,m,d,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),z(!0),a=t.getCanvas(),n=a.getContext("webgl")){e.next=7;break}return console.log("pas de gl"),e.abrupt("return");case 7:if(r=n.drawingBufferWidth,c=n.drawingBufferHeight,o=r,i=c,(l=document.getElementById("maposaic-cvs")).setAttribute("width",o.toString()),l.setAttribute("height",i.toString()),s=l.getContext("2d")){e.next=17;break}return e.abrupt("return");case 17:m=s.getImageData(0,0,l.width,l.height),d=m.data,f=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4),n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,f),R.onmessage=function(e){m.data.set(e.data),s.putImageData(m,0,0),z(!1),j(!1)},R.postMessage({mapboxPixels:f,maposaicData:d,webglWidth:r,webglHeight:c,viewportHeight:i,viewportWidth:o,roadColorThreshold:S,similarColorTolerance:D});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=a?a.getCenter():new p.a.LngLat(2.338272,48.858796),n=a?a.getZoom():12;a&&a.remove();var r=new p.a.Map({container:o.current?o.current:"",style:h,zoom:n,center:t});r.on("load",(function(){c(r),r.resize()})),r.on("dragstart",z),r.on("zoomstart",z),r.on("render",(function(){!r.loaded()||r.isMoving()||r.isZooming()||(R.terminate(),R=new k.a,e(r),F([r.getCenter().lng,r.getCenter().lat]))}))}),[S,D,h]);var J=Object(n.useState)(!1),U=Object(d.a)(J,2),Y=U[0],P=U[1];return r.a.createElement("div",{className:"container"},r.a.createElement("canvas",{className:"mosaic-canvas",width:"300",height:"300",id:"maposaic-cvs"}),r.a.createElement("div",{id:"mapbox-cvs",className:"mapbox-canvas",ref:function(e){return o.current=e},style:W}),r.a.createElement(l.a,{spinning:E,indicator:r.a.createElement(g.a,null)}),r.a.createElement("div",{className:"overmap"},r.a.createElement(C,{visible:Y,setDrawerVisible:P,changeMapStyle:function(e){z(!0),j(!0),v(e)},mapboxStyleURL:h,setNewRoadColorThreshold:function(e){B(e),j(!0)},setNewSimilarColorTolerance:function(e){G(e),j(!0)},flyTo:function(e){a&&(z(!0),j(!0),a.setCenter(e))},currentCenter:Z}),r.a.createElement(i.a,{type:"primary",shape:"circle",onClick:function(){P(!0)},icon:r.a.createElement(b.a,null)})))};var M=function(){return r.a.createElement(A,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},84:function(e,t,a){e.exports=function(){return new Worker(a.p+"e60194eb2689f829a04c.worker.js")}}},[[118,1,2]]]);
//# sourceMappingURL=main.13018a8d.chunk.js.map