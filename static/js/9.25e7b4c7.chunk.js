(this.webpackJsonpmaposaic=this.webpackJsonpmaposaic||[]).push([[9],{272:function(e,t,n){},502:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(97),o=n.n(c),r=n(98),l=n(88),i=n(139),s=n(0),u=n(120),d=n.n(u),m=(n(272),n(142)),f=n.n(m),p=n(496),h=n(501),j=n(491),v=n(66),b=n(141),w=n(30),g=n(511),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},x=n(81),_=function(e,t){return s.createElement(x.a,Object.assign({},e,{ref:t,icon:O}))};_.displayName="LeftOutlined";var y=s.forwardRef(_),L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},N=function(e,t){return s.createElement(x.a,Object.assign({},e,{ref:t,icon:L}))};N.displayName="RightOutlined";var C=s.forwardRef(N),S=n(186),R=n(109),E=n(187),k=function(e){return!!e.mapCenter&&!!e.colorConfig},U=n.p+"static/media/link.777d4327.svg",M=function(e){var t,n;return null!==(t=null!==(n=e.pictureName)&&void 0!==n?n:e.placeName)&&void 0!==t?t:"no name"},z=null,Z=null;t.default=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],u=Object(s.useState)(null),m=Object(l.a)(u,2),O=m[0],x=m[1],_=Object(s.useState)(!1),L=Object(l.a)(_,2),N=L[0],B=L[1],A=Object(s.useState)(!1),D=Object(l.a)(A,2),P=D[0],J=D[1],V=function(){var e=Object(r.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.collection("pictures").orderBy("timestamp","desc").get();case 3:n=e.sent,a=[],r=null,n.forEach((function(e){var n=e.data();if(n.downloadURL){r=null!==r?r+1:0,t&&e.id===t&&(x(r),B(!0));var c={id:e.id,pictureName:n.pictureName,downloadURL:n.downloadURL,placeName:n.placeName,thumbnailDownloadURL:n.thumbnailDownloadURL,colorConfig:n.colorConfig,mapCenter:n.mapCenter?new d.a.LngLat(n.mapCenter[0],n.mapCenter[1]):void 0,mapZoom:n.mapZoom,mapboxStyle:n.mapboxStyle};a.push(c)}})),c(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){var e=new URLSearchParams(window.location.search).get(S.a);V(e)}),[]),Object(s.useEffect)((function(){var e,t=new URLSearchParams(window.location.search),a=null!==O?null===(e=n[O])||void 0===e?void 0:e.id:null;a?t.set(S.a,a):t.delete(S.a),window.history.replaceState({},"","".concat(window.location.pathname,"?").concat(t))}),[O,n]);var X=function(e){null===O||e<0&&0===O||e>0&&O===n.length-1||(J(!1),x(Math.min(Math.max(0,O+e),n.length-1)))},Y=function(e){var t=e.key;"ArrowLeft"===t?X(-1):"ArrowRight"===t&&X(1)};Object(s.useEffect)((function(){return window.addEventListener("keydown",Y),function(){return window.removeEventListener("keydown",Y)}}));function G(e){var t=e.touches[0];z=t.clientX,Z=t.clientY}function I(e){if(z&&Z){var t=e.touches[0].clientX,n=e.touches[0].clientY,a=z-t,c=Z-n;Math.abs(a)>Math.abs(c)?X(a>0?1:-1):B(!1),z=null,Z=null}}Object(s.useEffect)((function(){if(N)return document.addEventListener("touchstart",G,!1),document.addEventListener("touchmove",I,!1),function(){document.removeEventListener("touchstart",G),document.removeEventListener("touchmove",I)}}),[N,O,n]);var W=function(e){var t=function(e){if(!e.mapCenter)return null;var t=new URLSearchParams;return t.set(R.d.Lat,e.mapCenter.lat.toString()),t.set(R.d.Lng,e.mapCenter.lng.toString()),e.mapZoom&&t.set(R.d.Zoom,e.mapZoom.toString()),e.mapboxStyle&&t.set(R.a,e.mapboxStyle),e.colorConfig?Object(E.b)(e.colorConfig,t):t}(e);k(e)&&t&&window.open("".concat(window.location.origin,"/?").concat(t))};return Object(a.jsxs)("div",{className:"gallery",children:[Object(a.jsx)(f.a,{level:2,children:"Gallery"}),Object(a.jsx)(w.b,{to:"/",children:"from maposaic"}),Object(a.jsx)(p.a,{}),Object(a.jsx)("div",{className:"gallery__pictures",children:n.map((function(e,t){var n;return Object(a.jsxs)("div",{onClick:function(){return function(e){e!==O&&J(!1),x(e),B(!0)}(t)},className:"gallery__picture",children:[Object(a.jsx)("img",{className:"gallery__picture__image",alt:"pic-".concat(M(e)),src:null!==(n=e.thumbnailDownloadURL)&&void 0!==n?n:e.downloadURL}),Object(a.jsx)("div",{className:"gallery__picture__name",children:M(e)})]},e.id)}))}),Object(a.jsx)(h.a,{closable:!1,visible:N,onCancel:function(){return B(!1)},bodyStyle:{display:"flex",justifyContent:"center",alignItems:"center"},footer:null,style:{maxWidth:"90vw",paddingBottom:"0",top:0},width:"fit-content",children:null!==O&&n.length>O&&O>=0&&Object(a.jsxs)("div",{className:"modal-content",children:[Object(a.jsx)("img",{className:"modal-content__picture",alt:"pic-".concat(M(n[O])),src:n[O].downloadURL,onLoad:function(){return J(!0)}}),Object(a.jsx)("div",{className:"modal-content__nav",children:k(n[O])?Object(a.jsx)(j.a,{title:"Explore maposaics from this picture",children:Object(a.jsxs)("div",{className:"modal-content__name",onClick:function(){return W(n[O])},children:[Object(a.jsx)("div",{children:P?M(n[O]):"..."}),Object(a.jsx)("img",{alt:"new-window",className:"modal-content__name__icon",src:U,width:"18px"})]})}):Object(a.jsx)("div",{children:P?M(n[O]):"..."})}),!P&&Object(a.jsx)(v.a,{className:"modal-content__loader",indicator:Object(a.jsx)(g.a,{style:{fontSize:"24px",color:"white"}})})]})}),N&&O&&O>0&&Object(a.jsx)(y,{className:"gallery__arrow gallery__arrow--left",style:{fontSize:"28px",color:b.a},onClick:function(){return X(-1)}}),N&&null!==O&&O+1<n.length&&Object(a.jsx)(C,{className:"gallery__arrow gallery__arrow--right",style:{fontSize:"28px",color:b.a},onClick:function(){return X(1)}})]})}}}]);
//# sourceMappingURL=9.25e7b4c7.chunk.js.map