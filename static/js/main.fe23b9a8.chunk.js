(this.webpackJsonpmaposaic=this.webpackJsonpmaposaic||[]).push([[0],{123:function(e,t,a){e.exports=a(233)},128:function(e,t,a){},224:function(e,t,a){},233:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),i=(a(128),a(91),a(51)),l=(a(130),a(116)),s=a(45),u=a.n(s),m=a(57),f=a(11),d=a(66),p=a.n(d),b=a(236),g=a(238),h=(a(133),a(119)),v=(a(235),a(90)),w=(a(137),a(52)),E=(a(139),a(88)),j=(a(234),a(118)),y=(a(144),a(120)),x=a(121),O=a(237),C=function(e){var t=e.flyTo,a=e.currentCenter,c=e.setDrawerVisible,o=Object(n.useState)(""),i=Object(f.a)(o,2),l=i[0],s=i[1],d=Object(n.useState)([]),p=Object(f.a)(d,2),g=p[0],h=p[1],v=Object(n.useState)(!1),w=Object(f.a)(v,2),E=w[0],C=w[1],S=function(){var e=Object(m.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(t),!(t.length<1)){e.next=4;break}return h([]),e.abrupt("return");case 4:return C(!0),n="".concat("https://api.mapbox.com/geocoding/v5/mapbox.places","/").concat(t,".json?limit=5&language=fr-FR&access_token=").concat(T,"&proximity=").concat(a[0],"%2C").concat(a[1]),e.next=8,fetch(n);case 8:return r=e.sent,e.next=11,r.json();case 11:c=e.sent,C(!1),h(c.features);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=g.map((function(e){var t=e.place_name.split(","),a=Object(x.a)(t),n=a[0],c=a.slice(1);return{value:e.id,label:r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:500}},n),r.a.createElement("div",null,c.join("")))}}));return r.a.createElement(j.a,{style:{width:200},onSearch:S,onSelect:function(e){var a=g.find((function(t){return t.id===e}));a&&(c(!1),t(a.center))},value:l,placeholder:"Search location",options:k},r.a.createElement(y.a,{suffix:E?r.a.createElement(b.a,null):r.a.createElement(O.a,null)}))},S=function(e){var t=e.visible,a=e.setDrawerVisible,c=e.mapboxStyleURL,o=e.changeMapStyle,i=e.setNewRoadColorThreshold,l=e.setNewSimilarColorTolerance,s=e.flyTo,u=e.currentCenter,m=Object(n.useState)(I),d=Object(f.a)(m,2),p=d[0],b=d[1],g=Object(n.useState)(W),j=Object(f.a)(g,2),y=j[0],x=j[1],O=function(e,t){t("number"===typeof e?e:e[0])};return r.a.createElement(h.a,{visible:t,placement:"left",onClose:function(){return a(!1)},closable:!1},r.a.createElement(C,{flyTo:s,currentCenter:u,setDrawerVisible:a}),r.a.createElement(E.a,null),r.a.createElement(w.a.Group,{onChange:function(e){a(!1),o(e.target.value)},value:c},r.a.createElement(w.a,{value:N.road},"Road boundaries"),r.a.createElement(w.a,{value:N.water},"Water boundaries"),r.a.createElement(w.a,{value:N.administrative},"Administrative boundaries")),r.a.createElement(E.a,null),r.a.createElement("p",null,"Boundary detection threshold"),r.a.createElement(v.a,{min:0,max:255,range:!1,value:p,onAfterChange:function(){i(p),a(!1)},onChange:function(e){return O(e,b)}}),r.a.createElement("p",null,"Fill Color Tolerance"),r.a.createElement(v.a,{min:0,max:20,range:!1,value:y,onAfterChange:function(){l(y),a(!1)},onChange:function(e){return O(e,x)}}))},k=a(89),B=a.n(k),T=(a(224),"pk.eyJ1IjoiY2FydGFwdWNlIiwiYSI6ImNrODM4ZmRnbjB2cnYzZ21zZGpidGdtanEifQ.A61azybL3BMEPJtn42dXKw");p.a.accessToken=T;var N={road:"mapbox://styles/cartapuce/ck8vk01zo2e5w1ipmytroxgf4",water:"mapbox://styles/cartapuce/ck8ynyj0x022h1hpmffi87im9",administrative:"mapbox://styles/cartapuce/ck8vkvxjt27z71ila3b3jecka"},I=50,W=3,D={width:"100vw",height:"calc(100vh)",position:"absolute"},R=new B.a,z=function(e){var t=document.getElementById("mapbox-cvs"),a=document.getElementById("maposaic-cvs");t.style.opacity=e?"1":"0",a.style.opacity=e?"0":"1"},A=function(){var e=Object(n.useState)(null),t=Object(f.a)(e,2),a=t[0],c=t[1],o=Object(n.useRef)(null),s=Object(n.useState)(N.road),d=Object(f.a)(s,2),h=d[0],v=d[1],w=Object(n.useState)(!1),E=Object(f.a)(w,2),j=E[0],y=E[1],x=Object(n.useState)(I),O=Object(f.a)(x,2),C=O[0],k=O[1],T=Object(n.useState)(W),A=Object(f.a)(T,2),M=A[0],G=A[1],H=Object(n.useState)([0,0]),L=Object(f.a)(H,2),Z=L[0],F=L[1];Object(n.useEffect)((function(){var e=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,c,o,i,l,s,m,f,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(!0),z(!0),a=t.getCanvas(),n=a.getContext("webgl")){e.next=7;break}return console.log("pas de gl"),e.abrupt("return");case 7:if(r=n.drawingBufferWidth,c=n.drawingBufferHeight,o=r,i=c,(l=document.getElementById("maposaic-cvs")).setAttribute("width",o.toString()),l.setAttribute("height",i.toString()),s=l.getContext("2d")){e.next=17;break}return e.abrupt("return");case 17:m=s.getImageData(0,0,l.width,l.height),f=m.data,d=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4),n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,d),R.onmessage=function(e){m.data.set(e.data),s.putImageData(m,0,0),z(!1),y(!1)},R.postMessage({mapboxPixels:d,maposaicData:f,webglWidth:r,webglHeight:c,viewportHeight:i,viewportWidth:o,roadColorThreshold:C,similarColorTolerance:M});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=a?a.getCenter():new p.a.LngLat(2.338272,48.858796),n=a?a.getZoom():12;a&&a.remove();var r=new p.a.Map({container:o.current?o.current:"",style:h,zoom:n,center:t});r.on("load",(function(){c(r),r.resize()})),r.on("dragstart",z),r.on("zoomstart",z),r.on("render",(function(){!r.loaded()||r.isMoving()||r.isZooming()||(R.terminate(),R=new B.a,e(r),F([r.getCenter().lng,r.getCenter().lat]))}))}),[C,M,h]);var J=Object(n.useState)(!1),U=Object(f.a)(J,2),V=U[0],Y=U[1];return r.a.createElement("div",{className:"container"},r.a.createElement("canvas",{className:"mosaic-canvas",width:"300",height:"300",id:"maposaic-cvs"}),r.a.createElement("div",{id:"mapbox-cvs",className:"mapbox-canvas",ref:function(e){return o.current=e},style:D}),r.a.createElement(l.a,{spinning:j,indicator:r.a.createElement(b.a,null)}),r.a.createElement("div",{className:"overmap"},r.a.createElement(S,{visible:V,setDrawerVisible:Y,changeMapStyle:function(e){z(!0),y(!0),v(e)},mapboxStyleURL:h,setNewRoadColorThreshold:function(e){k(e),y(!0)},setNewSimilarColorTolerance:function(e){G(e),y(!0)},flyTo:function(e){a&&(z(!0),y(!0),a.setCenter(e))},currentCenter:Z}),r.a.createElement(i.a,{type:"primary",shape:"circle",onClick:function(){Y(!0)},icon:r.a.createElement(g.a,null)})))};var M=function(){return r.a.createElement(A,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},89:function(e,t,a){e.exports=function(){return new Worker(a.p+"e60194eb2689f829a04c.worker.js")}}},[[123,1,2]]]);
//# sourceMappingURL=main.fe23b9a8.chunk.js.map